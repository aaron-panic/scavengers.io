{% extends 'admin.html' %}

{% block subcontent %}
    <h2 class="content-subcontent">user management</h2>
    <div id="admin-user-list">
        <div id="admin-user-record-header">
            <span>ID</span>
            <span>Username</span>
            <span>Email</span>
            <span>Role</span>
            <span>Joined</span>
            <span>Status</span>
        </div>

        {% for user in users %}
        <div class="admin-user-record">
            <span class="admin-user-id">{{ user.id }}</span>
            <span class="admin-user-username">{{ user.username }}</span>
            <span class="admin-user-email">{{ user.email }}</span>
            <span class="admin-user-role">{{ user.role }}</span>
            <span class="admin-user-joined">{{ user.created_at }}</span>
            <span class="admin-user-status-{{ user.status }}">
                {{ user.status }}
                {% if user.suspended_until %}
                - Suspended Until: {{ user.suspended_until }}
                {% endif %}
            </span>
            <span class="admin-user-actions">
                {% if user.status == 'requested' %}
                <form action="{{ url_for('admin.approve', user_id=user.id) }}" method="post" class="admin-user-control">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit" class="admin-user-control-button">[approve]</button>
                </form>
                <form action="{{ url_for('admin.deny', user_id=user.id) }}" method="post"
                        class="admin-user-control confirm-action" data-message="delete request for UID: {{ user.username }}?">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit" class="admin-user-control-button ">[deny]</button>
                </form>
                {% else %}
                <a href="#">[edit]</a>
                <a href="#">[suspend]</a>
                <a href="#">[ban]</a>
                {% endif %}
            </span>
        </div>
        {% endfor %}
    </div>
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
